<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time-Series Decomposition with BASTION • BASTION</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time-Series Decomposition with BASTION">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BASTION</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/non-technical_guide.html">Time-Series Decomposition with BASTION</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time-Series Decomposition with BASTION</h1>
            
      

      <div class="d-none name"><code>non-technical_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="why-bastion">1. Why BASTION?<a class="anchor" aria-label="anchor" href="#why-bastion"></a>
</h2>
<p><strong>Bayesian Adaptive Seasonality Trend decomposition
Incorporating Outliers and Noise (BASTION)</strong> is a Bayesian
framework for decomposing time series into trend and multiple
seasonality. Existing decomposition methods, though widely used, exhibit
several limitations:</p>
<ol style="list-style-type: decimal">
<li>Difficulty in adapting to abrupt changes in the trend,</li>
<li>Lack of robustness to outliers and heteroskedasticity</li>
<li>Absence of uncertainty quantification,</li>
<li>Inability to accommodate multiple seasonal patterns,</li>
</ol>
<p>BASTION is the first Bayesian method to effectively address all these
challenges in a unified framework.</p>
</div>
<div class="section level2">
<h2 id="example-with-simulated-data">2. Example with Simulated Data<a class="anchor" aria-label="anchor" href="#example-with-simulated-data"></a>
</h2>
<p>Let’s consider following simulated data below:</p>
<p><img src="non-technical_guide_files/figure-html/figure%20simulated%20data-1.png" width="864"><strong>Figure 1</strong>: Simulated Data with abrupt changes in trend,
outliers, and heteroskedastic noise term.</p>
<p>BASTION is fitted along with three other existing methods for
comparison:</p>
<ol style="list-style-type: decimal">
<li>
<strong>TBATS</strong> by <span class="citation">(Alysha M. De
Livera &amp; Snyder, 2011)</span>
</li>
<li>
<strong>MSTL</strong> by <span class="citation">(Bandara et al.,
2021)</span>
</li>
<li>
<strong>STR</strong> by <span class="citation">(Dokumentov &amp;
Hyndman, 2022)</span>.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::install_github("Jasoncho0914/BASTION")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BASTION</span><span class="op">)</span></span>
<span><span class="co">#running below takes about 5 minutes total.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">BASTION_sim</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_BASTION.html">fit_BASTION</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">[</span>,<span class="st">"y"</span><span class="op">]</span>,</span>
<span>                      Ks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">30</span><span class="op">)</span>,</span>
<span>                      Outlier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      cl<span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>                      obsSV <span class="op">=</span> <span class="st">"SV"</span>,</span>
<span>                      nsave <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                      nburn <span class="op">=</span> <span class="fl">4000</span><span class="op">)</span></span>
<span><span class="va">y_ts</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/msts.html" class="external-link">msts</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span>,<span class="st">"y"</span><span class="op">]</span>, seasonal.periods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TBATS</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tbats.html" class="external-link">tbats</a></span><span class="op">(</span><span class="va">y_ts</span><span class="op">)</span></span>
<span><span class="va">TBATScomp</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tbats.components.html" class="external-link">tbats.components</a></span><span class="op">(</span><span class="va">TBATS</span><span class="op">)</span></span>
<span><span class="va">STR</span> <span class="op">=</span> <span class="fu">stR</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/stR/reference/AutoSTR.html" class="external-link">AutoSTR</a></span><span class="op">(</span><span class="va">y_ts</span>,robust <span class="op">=</span> <span class="cn">TRUE</span>,confidence <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">MSTL</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/mstl.html" class="external-link">mstl</a></span><span class="op">(</span><span class="va">y_ts</span><span class="op">)</span></span></code></pre></div>
<p>One of the defining characteristic of the simulated data we see above
is the presence of abrupt changes in trend which occur around t = 74,
156, and 239.</p>
<p><img src="non-technical_guide_files/figure-html/figures_trend-1.png" width="864"><strong>Figure 2</strong>: The true trend componenet drawn in black and
the estimated trend component by TBATS, MSTL, STR, and BASTION are drawn
in blue. Dotted lines represent 95 percent confidence intervals for
TBATS and credible regions for STR.</p>
<p>Notice that BASTION provides:</p>
<ul>
<li>
<strong>Adaptive Trend Estimate</strong>: BASTION successfully
capture the abrupt changes resulting in the lowest mean squared error
(MSE), while also providing smooth estimate.</li>
<li>
<strong>Robust Uncertainty Quantification</strong>: BASTION achieves
98 percent empirical coverage based on its 95% credible region. Only
other existing decomposition method that provides uncertainty
quantification is STR <span class="citation">(Dokumentov &amp; Hyndman,
2022)</span>, the confidence interval provided by STR vastly
under-covers with 72.4 percent empirical coverage.</li>
</ul>
</div>
<div class="section level2">
<h2 id="daily-electricity-demand-in-new-york-state-">3. Daily Electricity Demand in New York State.<a class="anchor" aria-label="anchor" href="#daily-electricity-demand-in-new-york-state-"></a>
</h2>
<p>Let’s apply BASTION to a real-world dataset by analyzing the average
daily electricity demand (measured in megawatts per hour) for New York
State. This dataset, sourced from the New York Independent System
Operator (NYISO) via the U.S. Energy Information Administration <span class="citation">((EIA), 2024)</span>, exhibits a complex long-term
trend, intricate seasonal patterns, and heteroskedastic noise. Through
time-series decomposition, we will demonstrate how BASTION effectively
reveals underlying patterns that are otherwise obscured by noise.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">BASTION</span></span></span>
<span><span class="co">#&gt; Welcome to BASTION!</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">NYelectricity</span><span class="op">)</span></span></code></pre></div>
<p><img src="non-technical_guide_files/figure-html/figures%20electricity-1.png" width="864"><strong>Figure 3</strong>: Daily average electricity demand in New York
State from July 1, 2015, to June 30, 2024. The data represent the
average hourly electricity demand for each day, aggregated from hourly
observations.</p>
<p>Based on the raw data, we see the following:</p>
<ul>
<li>
<strong>Seasonal Patterns</strong>: Electricity demand peaks during
summer months due to air conditioning and rises again in winter for
heating needs.</li>
<li>
<strong>Heteroskedasticity</strong>: Variability is higher in summer
and winter (periods of peak demand) and lower during spring and fall
(more stable usage).</li>
<li>
<strong>Long-Term Trends</strong>: No significant long-term trend is
observed in electricity demand. A slight overall decline may indicate
the influence of improved energy efficiency over the years.</li>
</ul>
<div class="section level3">
<h3 id="decomposition-with-bastion">3.1 Decomposition with BASTION<a class="anchor" aria-label="anchor" href="#decomposition-with-bastion"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BASTION</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">BASTION_electric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_BASTION.html">fit_BASTION</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">NYelectricity</span><span class="op">$</span><span class="va">Demand..MW.</span>,</span>
<span>                                Ks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">365</span><span class="op">)</span>,</span>
<span>                                Outlier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                sparse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                obsSV <span class="op">=</span> <span class="st">"SV"</span>,</span>
<span>                                nsave <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                                nburn <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="va">elec_ts</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/msts.html" class="external-link">msts</a></span><span class="op">(</span><span class="va">NYelectricity</span><span class="op">$</span><span class="va">Demand..MW.</span>,seasonal.periods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">365</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">STR_elec</span> <span class="op">=</span> <span class="fu">stR</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/stR/reference/AutoSTR.html" class="external-link">AutoSTR</a></span><span class="op">(</span><span class="va">elec_ts</span>,confidence <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">TBATS_elec</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tbats.html" class="external-link">tbats</a></span><span class="op">(</span><span class="va">elec_ts</span>,use.trend <span class="op">=</span> <span class="cn">FALSE</span>,seasonal.periods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">365</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TBATScomp_elec</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tbats.components.html" class="external-link">tbats.components</a></span><span class="op">(</span><span class="va">TBATS_elec</span><span class="op">)</span></span>
<span><span class="va">MSTL_elec</span> <span class="op">=</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/mstl.html" class="external-link">mstl</a></span><span class="op">(</span><span class="va">elec_ts</span><span class="op">)</span></span></code></pre></div>
<p><img src="non-technical_guide_files/figure-html/figures%20electricity%20BASTION-1.png" width="864"><strong>Figure 4</strong>: Decomposition of the trend, weekly
seasonality, yearly seasonality, and volatility using BASTION for daily
average electricity demand from July 1, 2015, to June 30, 2024. Dark
grey regions represent the 95% credible intervals. To enhance clarity,
weekly seasonality is displayed for the period April 1, 2016, to July 1,
2016.</p>
<p>Notice that BASTION reveals patterns that are not apparent in the raw
data:</p>
<ul>
<li>
<strong>Trend Component</strong>:
<ul>
<li>A noticeable dip is observed during the winter of 2015–2016, driven
by a warmer-than-usual winter caused by a strong El Niño effect, which
reduced heating needs.</li>
<li>From January 2016 to April 2016, electricity demand steadily
increased, likely due to a colder-than-usual spring in early 2016 that
extended heating needs.</li>
<li>During the summer of 2016, electricity demand peaked, reflecting
increased air conditioning usage during one of the hottest summers on
record.</li>
<li>A noticeable dip in late 2019 likely reflects the impact of
COVID-19-related shutdowns.</li>
</ul>
</li>
<li>
<strong>Seasonality</strong>:
<ul>
<li>In addition to the yearly seasonal pattern driven by weather, weekly
pattern reveals that electricity demand is steady on weekdays and
decreases on weekends, consistent with common usage patterns.</li>
</ul>
</li>
<li>
<strong>Volatility</strong>:
<ul>
<li>BASTION’s time-varying volatility estimate highlights
heteroskedasticity in the noise term, with volatility also exhibiting
seasonal patterns.</li>
<li>Higher volatility is observed in winter months, while lower
volatility occurs during summer, closely aligning with the yearly
seasonality pattern.</li>
<li>BASTION uniquely models volatility directly, providing insights that
other decomposition methods cannot.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="comparisons-to-other-models">3.2 Comparisons to Other Models<a class="anchor" aria-label="anchor" href="#comparisons-to-other-models"></a>
</h3>
<p>I would like to direct our attention to the yearly seasonal estimates
in comparison with the ones produced by the three existing models.
<img src="non-technical_guide_files/figure-html/Electricity%20comparison-1.png" width="864"><strong>Figure 5</strong>: Yearly seasonality estimates for daily
average electricity demand in New York from July 2015 to June 2017.
Estimates from TBATS, MSTL, STR, and BASTION are displayed
respectively.</p>
<ul>
<li><p><strong>Overall Seasonal Patterns</strong>: All methods (BASTION,
MSTL, STR, and TBATS) capture the East Coast’s seasonal patterns,
including peak demand in summer (July and August) due to cooling needs,
a decline in fall as temperatures moderate, and a rise in winter
reflecting heating requirements.</p></li>
<li><p><strong>Holiday Season Effect</strong>: BASTION and MSTL detect a
30-day dip in demand (mid-December to mid-January) during the holiday
season, reflecting reduced commercial and industrial activity.</p></li>
<li><p><strong>BASTION’s Strength</strong>: BASTION excels at detecting
subtle seasonal changes while maintaining smooth, accurate estimates of
components.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">4. Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>BASTION effectively addresses the limitations of existing time-series
decomposition methods by providing adaptive trend estimation, robust
handling of outliers, and direct modeling of volatility. Its ability to
capture nuanced seasonal patterns and abrupt changes in the data makes
it a valuable tool for real-world applications.</p>
<p>For technical details of BASTION, see the <a href="paper/BASTION_20250124.pdf">main paper</a>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-tbats" class="csl-entry">
Alysha M. De Livera, R. J. H., &amp; Snyder, R. D. (2011). Forecasting
time series with complex seasonal patterns using exponential smoothing.
<em>Journal of the American Statistical Association</em>,
<em>106</em>(496), 1513–1527. <a href="https://doi.org/10.1198/jasa.2011.tm09771" class="external-link">https://doi.org/10.1198/jasa.2011.tm09771</a>
</div>
<div id="ref-MSTL" class="csl-entry">
Bandara, K., Hyndman, R. J., &amp; Bergmeir, C. (2021). <em>MSTL: A
seasonal-trend decomposition algorithm for time series with multiple
seasonal patterns</em>. <a href="https://arxiv.org/abs/2107.13462" class="external-link">https://arxiv.org/abs/2107.13462</a>
</div>
<div id="ref-STR" class="csl-entry">
Dokumentov, A., &amp; Hyndman, R. J. (2022). STR: Seasonal-trend
decomposition using regression. <em>INFORMS Journal on Data
Science</em>, <em>1</em>(1), 50–62. <a href="https://doi.org/10.1287/ijds.2021.0004" class="external-link">https://doi.org/10.1287/ijds.2021.0004</a>
</div>
<div id="ref-nyis_electricity" class="csl-entry">
(EIA), U. S. E. I. A. (2024). <em>New york independent system operator
electricity demand data</em>. <a href="https://www.eia.gov/electricity/gridmonitor/dashboard/electric_overview/regional/REG-NY" class="external-link">https://www.eia.gov/electricity/gridmonitor/dashboard/electric_overview/regional/REG-NY</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason B. Cho.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
